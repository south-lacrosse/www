(()=>{let p,h,f,b,C,y=null,E,L,w=!0,v=null,k=8,M=["gb"];function S(){T(this.semlaClub)}function T(e){L.close();let t='<h2 style="margin:0;border:0;font-size:1rem">'+e.name+"</h2>";w||(t+='<p style="margin:0;font-size:0.75rem">('+e.dist+" miles from search)</p>"),t+='<p style="margin:1em 0 0;font-size:1rem">'+e.html+' <a style="margin-left:1.5em" href="https://www.google.co.uk/maps/dir//'+e.latLng.toUrlValue()+"/@"+e.latLng.toUrlValue()+',16z">Directions</a></p>',L.setContent(t),L.open({anchor:e.marker,map:C})}function B(){var e=n(p),t=n(b)-e-p.offsetHeight,e=window.innerHeight-e-t-b.offsetHeight,e=Math.max(300,e),t=Math.round(e)+"px";p.style.height=t,h.style.height=t,C&&google.maps.event.trigger(C,"resize")}function n(e){let t=0;for(;e;)t+=e.offsetTop,e=e.offsetParent;return t}function P(e,t){return e.dist-t.dist}function x(e,t){return e.name<t.name?-1:t.name<e.name?1:0}function I(e){return e*Math.PI/180}(async()=>{var[{Map:e,InfoWindow:t},{ControlPosition:n,LatLng:a,LatLngBounds:l},{PlaceAutocompleteElement:r},{AdvancedMarkerElement:o}]=await Promise.all([google.maps.importLibrary("maps"),google.maps.importLibrary("core"),google.maps.importLibrary("places"),google.maps.importLibrary("marker")]),s=(p=document.getElementById("map"),h=document.getElementById("map-key"),f=document.getElementById("clubs-list"),b=document.getElementById("page-footer"),B(),window.addEventListener("resize",B,!1),SemlaClubs.length);E=new l;for(let e=s;e--;){var i=SemlaClubs[e];i.latLng=new a(i.lat,i.lng),E.extend(i.latLng)}var m=E.getNorthEast(),c=E.getSouthWest(),l=new l(new a(c.lat()-6,c.lng()-6),new a(m.lat()+6,m.lng()+6));(C=new e(p,{center:E.getCenter(),fullscreenControl:!0,scaleControl:!0,mapId:window.location.host.startsWith("dev")?"DEMO_MAP_ID":"96908cc41d8bdc4f",restriction:{latLngBounds:l,strictBounds:!1}})).fitBounds(E),L=new t;let d="";for(let e=0;e<s;e++){var g=SemlaClubs[e],u=new o({map:C,title:g.name,position:g.latLng});g.marker=u,g.order=e,u.semlaClub=g,u.addListener("click",S),d+='<li title="'+g.name+'" data-index="'+e+'">'+g.name+"</li>"}f.innerHTML=d,f.addEventListener("click",function(e){var e=e.target.getAttribute("data-index");null!==e&&(e=SemlaClubs[e],C.getZoom()<9?(C.setZoom(9),C.setCenter(e.latLng)):C.panTo(e.latLng),T(e))},!1),document.getElementById("toggle-key").addEventListener("click",function(e){e.preventDefault(),-1<(y=y||document.getElementById("map-container")).className.indexOf("hide-key")?(y.className=y.className.replace(" hide-key",""),this.innerHTML="Hide Key"):(y.className+=" hide-key",this.innerHTML="Show Key"),google.maps.event.trigger(C,"resize")},!1),(c=document.createElement("div")).className="map-ctl",c.title="Centre all clubs on the map",c.innerHTML='<button type="button" class="map-ctl-text">Centre</button>',c.firstElementChild.addEventListener("click",function(){C.fitBounds(E),C.setCenter(E.getCenter())}),C.controls[n.LEFT_TOP].push(c),(m=document.createElement("div")).className="search-wrapper",m.innerHTML='<p style="margin-bottom:0.5em">Search for clubs near:</p><button class="search-reset" title="Reset search for nearest clubs">Reset</button>',(e=new r({includedRegionCodes:M})).id="search-box",m.firstElementChild.after(e),e.addEventListener("gmp-select",async({placePrediction:t})=>{var t=t.toPlace(),n=(await t.fetchFields({fields:["formattedAddress","location"]}),t.location),e=(C.getZoom()>k?(C.setZoom(k),C.setCenter(n)):C.panTo(n),v||(e=new google.maps.marker.PinElement({background:"#5383EC",glyphColor:"#324F8E",borderColor:"#324F8E"}),(v=new google.maps.marker.AdvancedMarkerElement({map:C,content:e.element})).addListener("click",function(){L.setContent('<p style="margin:0;font-size:1rem;font-weight:400">Search near: '+this.title+"</p>"),L.open({anchor:this,map:C})})),v.position=n,v.title=t.formattedAddress,v.map=C,I(n.lat())),a=Math.sin(e),l=Math.cos(e);for(let e=t=SemlaClubs.length;e--;){var r=SemlaClubs[e],o=I(r.lat),o=3959*Math.acos(a*Math.sin(o)+l*Math.cos(o)*Math.cos(I(n.lng()-r.lng)));r.dist=o.toFixed(2)}SemlaClubs.sort(P),w=!1,L.close();var s=f.getElementsByTagName("li");for(let e=t;e--;){var i=SemlaClubs[e],m=(i.order=e)+1+". "+i.name+" "+i.dist+" mi",c=new google.maps.marker.PinElement({glyph:""+(e+1)});i.marker.content=c.element,i.marker.title=m,s[e].textContent=m,s[e].setAttribute("title",m)}}),m.lastElementChild.addEventListener("click",function(){if(!w){L.close(),v.map=null,SemlaClubs.sort(x),w=!0;var t=f.getElementsByTagName("li");for(let e=SemlaClubs.length;e--;){var n=SemlaClubs[e];n.order=e,n.marker.content=null,n.marker.title=n.name,t[e].textContent=n.name,t[e].setAttribute("title",n.name)}}}),C.controls[n.TOP_RIGHT].push(m)})()})();