!function(){"use strict";let g,u,h,f,p,y=null,L,n=null,E=null,v=null,a=-1,t=9,c=!0;const o={UNKNOWN_ERROR:"The request could not be successfully processed, yet the exact reason for the failure is not known",OVER_QUERY_LIMIT:"The webpage has gone over the requests limit in too short a time",REQUEST_DENIED:"The webpage is not allowed to use the geocoder",INVALID_REQUEST:"This request was invalid",ZERO_RESULTS:"The address is unknown, please try another",ERROR:"There was a problem contacting the Google servers"};function b(){k(this.semlaClub)}function C(){u.getElementsByTagName("li")[this.semlaClub.order].className+=" hover"}function T(){var e=u.getElementsByTagName("li")[this.semlaClub.order];e.className=e.className.replace(" hover","")}function w(e,t){t===google.maps.GeocoderStatus.OK?B(e[0].geometry.location):alert(o[t])}function N(e){p.getZoom()<t?(p.setZoom(t),p.setCenter(e)):p.panTo(e)}function M(){var e=p.mapTypes.get(p.getMapTypeId()),t=e.maxZoom||21,n=e.minZoom||0,e=p.getProjection(),a=e.fromLatLngToPoint(L.getNorthEast()),e=e.fromLatLngToPoint(L.getSouthWest()),o=Math.abs(a.x-e.x),s=Math.abs(a.y-e.y);let l;for(l=t;l>=n&&!(o*(1<<l)+80<g.firstChild.offsetWidth&&s*(1<<l)+80<g.firstChild.offsetHeight);--l);p.setCenter(L.getCenter()),p.setZoom(l)}function k(e){n||(n=new google.maps.InfoWindow).addListener("closeclick",s);let t='<div style="margin: 0.1em"><b>'+e.name+"</b>";c||(t+="<br>("+e.dist+" miles from search)"),t+="<br><br>"+e.html+' <a style="padding-left:20px" href="https://www.google.co.uk/maps/dir//'+e.latLng.toUrlValue()+"/@"+e.latLng.toUrlValue()+',16z">directions</a></div>',n.setContent(t),-1!==a&&(u.getElementsByTagName("li")[a].className=""),a=e.order,u.getElementsByTagName("li")[a].className="selected",n.open(p,e.marker)}function d(){n&&(n.close(),s())}function s(){-1!==a&&(u.getElementsByTagName("li")[a].className="",a=-1)}function S(){var e=l(g),t=l(h)-e-g.offsetHeight,e=window.innerHeight-e-t-h.offsetHeight,e=Math.max(300,e),t=Math.round(e)+"px";g.style.height=t,u.style.height=t,p&&google.maps.event.trigger(p,"resize")}function l(e){let t=0;for(;e;)t+=e.offsetTop,e=e.offsetParent;return t}function B(e){N(e);let t;var n=SemlaClubs.length,a=x(e.lat()),o=Math.sin(a),s=Math.cos(a);for(t=n;t--;){var l=SemlaClubs[t],r=x(l.lat);l.dist=3959*Math.acos(o*Math.sin(r)+s*Math.cos(r)*Math.cos(x(e.lng()-l.lng)))}SemlaClubs.sort(I),c=!1,d();var i=u.getElementsByTagName("li");for(t=n;t--;){var m=SemlaClubs[t];m.order=t,m.marker.setLabel(""+(t+1)),m.dist=m.dist.toFixed(2),i[t].firstChild.nodeValue=t+1+". "+m.name+" "+m.dist+" mi"}}function I(e,t){return e.dist-t.dist}function e(e,t){return e.name<t.name?-1:e.name>t.name?1:0}function R(){if(!c){SemlaClubs.sort(e),c=!0,d();var t=u.getElementsByTagName("li");for(let e=SemlaClubs.length;e--;){var n=SemlaClubs[e];n.order=e,n.marker.setLabel(""),t[e].firstChild.nodeValue=n.name}}}function x(e){return e*Math.PI/180}!async function(){var{Map:e,MapTypeControlStyle:t}=await google.maps.importLibrary("maps"),{ControlPosition:n,LatLng:a,LatLngBounds:o}=await google.maps.importLibrary("core"),s=(await google.maps.importLibrary("places"))["Autocomplete"],l=(g=document.getElementById("map"),u=document.getElementById("map-key"),h=document.getElementById("page-footer"),S(),window.addEventListener("resize",S,!1),document.getElementById("toggle-key").addEventListener("click",function(e){e.preventDefault(),-1<(y=y||document.getElementById("map-container")).className.indexOf("hide-key")?(y.className=y.className.replace(" hide-key",""),this.innerHTML="Hide Key"):(y.className+=" hide-key",this.innerHTML="Show Key"),p&&google.maps.event.trigger(p,"resize")},!1),SemlaClubs.length);let r;for(L=new o,r=l;r--;){var i=SemlaClubs[r];i.latLng=new a(i.lat,i.lng),L.extend(i.latLng)}(p=new e(g,{center:L.getCenter(),fullscreenControl:!0,scaleControl:!0,mapTypeControlOptions:{style:t.DROPDOWN_MENU},zoom:6})).fitBounds(L),p.addListener("resize",function(){E=this.getCenter()}),p.addListener("bounds_changed",function(){E&&this.setCenter(E),E=null});let m="";for(r=0;r<l;r++){var c=SemlaClubs[r],d=new google.maps.Marker({map:p,title:c.name,optimized:!1,position:c.latLng,semlaClub:c});c.marker=d,c.order=r,d.addListener("click",b),d.addListener("mouseover",C),d.addListener("mouseout",T),m+="<li>"+c.name+"</li>"}(e=document.getElementById("clubs-list")).innerHTML=m,e.addEventListener("click",function(e){e=function(n){var a=n.parentNode.childNodes;let o=0;for(let e=0,t=a.length;e<t;e++){if(a[e]===n)return o;1===a[e].nodeType&&o++}return-1}(e.target),e=SemlaClubs[e];N(e.latLng),k(e)},!1),(t=document.createElement("div")).className="gmnoprint",(e=document.createElement("div")).className="map-ctl",e.title="Click to recentre the map",e.innerHTML='<div class="map-ctl-text">Centre Map</div>',e.addEventListener("click",M),t.appendChild(e),p.controls[n.LEFT_TOP].push(t),p.controls[n.TOP_RIGHT].push(document.getElementById("search-wrapper")),new s(f=document.getElementById("search-box"),{bounds:new o(new a(50,-6),new a(54,2)),componentRestrictions:{country:"gb"}}).addListener("place_changed",function(){var e=this.getPlace();if(!e.geometry)return""===e.name.trim()?void R():void(v=v||new google.maps.Geocoder).geocode({address:e.name.trim()},w);B(e.geometry.location)}),document.getElementById("search-reset").addEventListener("click",function(){f.value="",R()})}()}();